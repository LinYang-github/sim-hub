<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èµ„æºæ·±åº¦è´¨æ£€ - Demo Preview</title>
    <style>
        :root {
            --bg: #ffffff;
            --surface: #f8fafc;
            --primary: #4f46e5;
            --text: #0f172a;
            --border: #e2e8f0;
            --meta: #64748b;
            --accent-bg: #dcfce7;
            --accent-text: #166534;
        }

        html.dark {
            --bg: #020617;
            --surface: #0f172a;
            --primary: #818cf8;
            --text: #f1f5f9;
            --border: #1e293b;
            --meta: #94a3b8;
            --accent-bg: #064e3b;
            --accent-text: #34d399;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, system-ui, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg);
            color: var(--text);
            transition: background 0.4s ease;
        }

        .inspector-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .icon-box {
            width: 56px;
            height: 56px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .title-group h2 {
            margin: 0;
            font-size: 18px;
            font-weight: 700;
        }

        .title-group p {
            margin: 2px 0 0;
            font-size: 12px;
            color: var(--meta);
        }

        .spec-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 24px;
        }

        .spec-item {
            background: var(--surface);
            padding: 12px 16px;
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .spec-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--meta);
            margin-bottom: 4px;
        }

        .spec-value {
            font-size: 14px;
            font-weight: 600;
        }

        .analysis-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
        }

        .analysis-title {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            justify-content: space-between;
        }

        .tag {
            background: #dcfce7;
            color: #166534;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        .progress-row {
            margin-bottom: 16px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 6px;
        }

        .progress-bar {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-inner {
            height: 100%;
            background: var(--primary);
            transition: width 1s ease-in-out;
        }

        .raw-data {
            margin-top: 24px;
            font-family: monospace;
            font-size: 11px;
            background: #000;
            color: #af0;
            padding: 12px;
            border-radius: 8px;
            white-space: pre-wrap;
            max-height: 150px;
            overflow: auto;
            border: 1px solid #333;
        }
    </style>
</head>
<body>
    <div class="inspector-container">
        <div class="header">
            <div class="icon-box" id="icon">ğŸ“¦</div>
            <div class="title-group">
                <h2 id="name">æœªé€‰æ‹©èµ„æº</h2>
                <p id="id">Waiting for data synchronization...</p>
            </div>
        </div>

        <div class="spec-grid">
            <div class="spec-item">
                <div class="spec-label">ç‰ˆæœ¬ç¼–å·</div>
                <div class="spec-value" id="version">-</div>
            </div>
            <div class="spec-item">
                <div class="spec-label">èµ„æºçŠ¶æ€</div>
                <div class="spec-value" id="status">-</div>
            </div>
            <div class="spec-item">
                <div class="spec-label">å¯è§èŒƒå›´</div>
                <div class="spec-value" id="scope">-</div>
            </div>
            <div class="spec-item">
                <div class="spec-label">ç”Ÿå‘½å‘¨æœŸ</div>
                <div class="spec-value" id="lifecycle">Normal</div>
            </div>
        </div>

        <div class="analysis-card">
            <div class="analysis-title">
                <span>è‡ªåŠ¨åŒ–åˆ†ææŠ¥å‘Š (AI Audit)</span>
                <span class="tag">PASS</span>
            </div>
            
            <div class="progress-row">
                <div class="progress-header">
                    <span>å…ƒæ•°æ®å®Œæ•´åº¦</span>
                    <span id="score1">0%</span>
                </div>
                <div class="progress-bar"><div class="progress-inner" style="width: 0%" id="bar1"></div></div>
            </div>

            <div class="progress-row">
                <div class="progress-header">
                    <span>æ‹“æ‰‘å…³è”å¼ºåº¦</span>
                    <span id="score2">0%</span>
                </div>
                <div class="progress-bar"><div class="progress-inner" style="width: 0%" id="bar2"></div></div>
            </div>

            <p style="font-size: 11px; color: var(--meta); line-height: 1.6; margin: 0;">
                åŸºäºå½“å‰å¿«ç…§çš„æ·±åº¦å¯å‘å¼å®¡è®¡ï¼Œæœªå‘ç°å…³é”®æ€§åç§»ã€‚è¯¥èµ„æºç¬¦åˆç³»ç»Ÿå®šä¹‰çš„ V2 çº§éƒ¨ç½²æ ‡å‡†ã€‚
            </p>
        </div>

        <div class="raw-data" id="json-dump">// RAW DATA DUMP</div>
    </div>

    <script>
        const SimHubBridge = {
            init() {
                window.addEventListener('message', (e) => {
                    const data = e.data;
                    if (data.type === 'THEME_UPDATE') {
                        document.documentElement.classList.toggle('dark', data.payload.theme === 'dark');
                    }
                    if (data.type === 'PREVIEW_DATA' && data.payload.resource) {
                        this.render(data.payload.resource);
                    }
                });
                // Notify host we are ready
                window.parent.postMessage({ type: 'GUEST_READY' }, '*');
            },
            render(res) {
                if (!res) return;
                
                // Handle different incoming data structures (Single resource or Collection)
                const item = res.name ? res : (res.resources ? res.resources[0] : null);
                if (!item) return;

                document.getElementById('name').innerText = item.name;
                document.getElementById('id').innerText = 'UID: ' + item.id;
                document.getElementById('version').innerText = item.latest_version?.semver || 'v1.0.0';
                document.getElementById('status').innerText = item.latest_version?.state || 'ACTIVE';
                document.getElementById('scope').innerText = item.scope || 'PUBLIC';
                
                // Set fake scores
                const s1 = 85 + Math.floor(Math.random() * 15);
                const s2 = 40 + Math.floor(Math.random() * 40);
                
                setTimeout(() => {
                    document.getElementById('score1').innerText = s1 + '%';
                    document.getElementById('bar1').style.width = s1 + '%';
                    document.getElementById('score2').innerText = s2 + '%';
                    document.getElementById('bar2').style.width = s2 + '%';
                }, 100);

                document.getElementById('json-dump').innerText = JSON.stringify(item, null, 2);
            }
        };

        SimHubBridge.init();
    </script>
</body>
</html>
